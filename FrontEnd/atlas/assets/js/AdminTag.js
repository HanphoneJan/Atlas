import{d as e,r as a,x as l,a as t,e as o,w as s,h as n,k as r,E as u,o as i,b as d,i as c,F as m,y as p,j as v,q as f,J as y,D as g,t as b,G as _,_ as x}from"./index.js";import{E as w}from"./api.js";const k={style:{display:"flex","justify-content":"center","margin-bottom":"20px"}},T={class:"op",style:{position:"absolute",right:"5px",top:"5px"}},h={style:{color:"#3a8ee6"}},C={style:{"margin-bottom":"0"}},E={style:{color:"#2ac06d"}},A=x(e({__name:"AdminTag",setup(e){const x=a([]),A=a(!1),V=a(null),G=a({name:""}),j={name:[{required:!0,message:"标签名称不能为空",trigger:"blur"}]},F=a({id:null,name:""}),D=async()=>{try{const{data:e}=await r.get(w.GETADMINTAG);830===e.status?(x.value=e.data,console.log("标签列表加载成功")):u.error("标签列表加载失败")}catch(e){console.error("获取标签列表失败:",e.message),u.error("获取标签列表失败，请稍后再试")}},I=async()=>{V.value&&V.value.validate((async e=>{if(!e)return;F.value.name=G.value.name;const{data:a}=await r.post(w.CREATETAG,{tag:F.value});830===a.status&&(A.value=!1,F.value.id=null,V.value.resetFields(),u.success("创建成功"),await D())}))},q=()=>{A.value=!1,G.value.name="",V.value?.resetFields()};return l(D),(e,a)=>{const l=n("el-button"),B=n("el-card"),R=n("el-col"),U=n("el-row"),J=n("el-input"),L=n("el-form-item"),M=n("el-form"),N=n("el-dialog");return i(),t("div",null,[o(B,{shadow:"never"},{default:s((()=>[d("div",k,[o(l,{type:"primary",onClick:a[0]||(a[0]=e=>A.value=!0)},{default:s((()=>a[3]||(a[3]=[c("新建标签")]))),_:1})]),o(U,{gutter:20},{default:s((()=>[(i(!0),t(m,null,p(x.value,(e=>(i(),v(R,{sm:8,lg:6,key:e.id,style:{"margin-bottom":"20px"}},{default:s((()=>[o(B,{shadow:"hover",style:{position:"relative",border:"2px solid #eee","text-align":"left"}},{default:s((()=>[d("div",T,[o(l,{onClick:a=>{return l=e.id,F.value.id=l,void(A.value=!0);var l},icon:f(y),style:{color:"#3a8ee6","margin-right":"5px"}},null,8,["onClick","icon"]),o(l,{onClick:a=>(async e=>{try{await _.confirm("此操作将永久删除该标签, 是否继续","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"});const{data:a}=await r.post(w.DELETETAG,{tagId:e});830===a.status&&await D()}catch{u.info("已取消删除")}})(e.id),icon:f(g),style:{color:"red"}},null,8,["onClick","icon"])]),d("b",null,[a[4]||(a[4]=c(" 标签名称 ")),d("span",h,b(e.name),1)]),a[6]||(a[6]=c()),a[7]||(a[7]=d("br",null,null,-1)),d("p",C,[a[5]||(a[5]=c("图片数量 ")),d("span",E,b(e.number),1)])])),_:2},1024)])),_:2},1024)))),128))])),_:1})])),_:1}),o(N,{title:"修改标签",modelValue:A.value,"onUpdate:modelValue":a[2]||(a[2]=e=>A.value=e)},{footer:s((()=>[o(l,{onClick:q},{default:s((()=>a[8]||(a[8]=[c("取消")]))),_:1}),o(l,{type:"primary",onClick:I},{default:s((()=>a[9]||(a[9]=[c("提交")]))),_:1})])),default:s((()=>[o(M,{style:{"text-align":"left"},ref_key:"createTagFormRef",ref:V,model:G.value,rules:j,"label-width":"80px"},{default:s((()=>[o(L,{label:"标签名称",prop:"name"},{default:s((()=>[o(J,{modelValue:G.value.name,"onUpdate:modelValue":a[1]||(a[1]=e=>G.value.name=e)},null,8,["modelValue"])])),_:1})])),_:1},8,["model"])])),_:1},8,["modelValue"])])}}}),[["__scopeId","data-v-8dbbb40a"]]);export{A as default};
